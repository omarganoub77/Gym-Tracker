<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Gym Tracker">
    <meta name="theme-color" content="#0f172a">
    <title>Gym Tracker</title>
    <link rel="manifest" href="data:application/json;base64,ewogICJuYW1lIjogIkd5bSBUcmFja2VyIiwKICAic2hvcnRfbmFtZSI6ICJHeW0iLAogICJzdGFydF91cmwiOiAiLiIsCiAgImRpc3BsYXkiOiAic3RhbmRhbG9uZSIsCiAgImJhY2tncm91bmRfY29sb3IiOiAiIzBmMTcyYSIsCiAgInRoZW1lX2NvbG9yIjogIiMzYjgyZjYiCn0=">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * { -webkit-tap-highlight-color: transparent; }
        body { overscroll-behavior: none; background-color: #020617; }
        .no-select { -webkit-user-select: none; user-select: none; }
        input, textarea, select { font-size: 16px !important; }
        .animate-fade-in { animation: fadeIn 0.2s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="bg-slate-950 text-white font-sans">
    <div id="app"></div>

    <script>
        const defaultWorkouts = {
            upper1: {
                id: 'upper1',
                name: 'Upper 1',
                subtitle: 'Strength Focus',
                color: 'bg-red-500',
                exercises: [
                    { id: 'u1e1', name: 'Dumbbell Bench Press', sets: 4, reps: '6-8', rest: 180, muscle: 'Chest' },
                    { id: 'u1e2', name: 'Cable/Machine Row', sets: 4, reps: '6-8', rest: 180, muscle: 'Back' },
                    { id: 'u1e3', name: 'Overhead Press', sets: 3, reps: '8-10', rest: 120, muscle: 'Shoulders' },
                    { id: 'u1e4', name: 'Pull-ups/Lat Pulldown', sets: 3, reps: '8-10', rest: 120, muscle: 'Back' },
                    { id: 'u1e5', name: 'Dumbbell Curl', sets: 3, reps: '10-12', rest: 90, muscle: 'Biceps' },
                    { id: 'u1e6', name: 'Preacher Curl', sets: 3, reps: '10-12', rest: 90, muscle: 'Biceps' },
                    { id: 'u1e7', name: 'Tricep Dips', sets: 3, reps: '10-12', rest: 90, muscle: 'Triceps' },
                    { id: 'u1e8', name: 'Face Pulls', sets: 3, reps: '15-20', rest: 60, muscle: 'Rear Delts' }
                ]
            },
            lower1: {
                id: 'lower1',
                name: 'Lower 1',
                subtitle: 'Strength Focus',
                color: 'bg-blue-500',
                exercises: [
                    { id: 'l1e1', name: 'Belt Squat', sets: 4, reps: '6-8', rest: 180, muscle: 'Quads' },
                    { id: 'l1e2', name: 'Romanian Deadlift', sets: 3, reps: '8-10', rest: 180, muscle: 'Hamstrings' },
                    { id: 'l1e3', name: 'Leg Press', sets: 3, reps: '10-12', rest: 120, muscle: 'Quads' },
                    { id: 'l1e4', name: 'Leg Curl', sets: 3, reps: '10-12', rest: 90, muscle: 'Hamstrings' },
                    { id: 'l1e5', name: 'Walking Lunges', sets: 3, reps: '12 each', rest: 90, muscle: 'Quads/Glutes' },
                    { id: 'l1e6', name: 'Standing Calf Raise', sets: 4, reps: '12-15', rest: 60, muscle: 'Calves' },
                    { id: 'l1e7', name: 'Plank', sets: 3, reps: '60s', rest: 60, muscle: 'Core' }
                ]
            },
            plyo: {
                id: 'plyo',
                name: 'Plyo/Power',
                subtitle: 'Conditioning',
                color: 'bg-purple-500',
                exercises: [
                    { id: 'p1', name: 'Box Jumps', sets: 4, reps: '8', rest: 120, muscle: 'Power' },
                    { id: 'p2', name: 'Plyometric Push-ups', sets: 3, reps: '10', rest: 90, muscle: 'Upper Power' },
                    { id: 'p3', name: 'Lateral Jumps', sets: 3, reps: '10 each', rest: 90, muscle: 'Power' },
                    { id: 'p4', name: 'Burpees', sets: 4, reps: '15', rest: 90, muscle: 'Conditioning' },
                    { id: 'p5', name: 'Ladder Drills (High Knees)', sets: 4, reps: '20 yards', rest: 60, muscle: 'Agility' },
                    { id: 'p6', name: 'Ladder Drills (In-Out)', sets: 4, reps: '20 yards', rest: 60, muscle: 'Agility' },
                    { id: 'p7', name: 'Broad Jumps', sets: 3, reps: '8', rest: 120, muscle: 'Power' },
                    { id: 'p8', name: 'Medicine Ball Slams', sets: 3, reps: '12', rest: 60, muscle: 'Power' },
                    { id: 'p9', name: 'Sprint Intervals', sets: 6, reps: '50m', rest: 180, muscle: 'Speed' },
                    { id: 'p10', name: 'Jump Rope', sets: 3, reps: '60s', rest: 60, muscle: 'Conditioning' }
                ]
            },
            upper2: {
                id: 'upper2',
                name: 'Upper 2',
                subtitle: 'Hypertrophy Focus',
                color: 'bg-orange-500',
                exercises: [
                    { id: 'u2e1', name: 'Incline Dumbbell Press', sets: 4, reps: '10-12', rest: 120, muscle: 'Chest' },
                    { id: 'u2e2', name: 'Cable Row', sets: 4, reps: '10-12', rest: 120, muscle: 'Back' },
                    { id: 'u2e3', name: 'Dumbbell Shoulder Press', sets: 3, reps: '10-12', rest: 90, muscle: 'Shoulders' },
                    { id: 'u2e4', name: 'Lat Pulldown (Wide)', sets: 3, reps: '12-15', rest: 90, muscle: 'Back' },
                    { id: 'u2e5', name: 'Cable Flyes', sets: 3, reps: '12-15', rest: 60, muscle: 'Chest' },
                    { id: 'u2e6', name: 'Hammer Curls', sets: 3, reps: '12-15', rest: 60, muscle: 'Biceps' },
                    { id: 'u2e7', name: 'Cable Curl', sets: 3, reps: '12-15', rest: 60, muscle: 'Biceps' },
                    { id: 'u2e8', name: 'Overhead Tricep Extension', sets: 3, reps: '12-15', rest: 60, muscle: 'Triceps' }
                ]
            },
            lower2: {
                id: 'lower2',
                name: 'Lower 2',
                subtitle: 'Hypertrophy Focus',
                color: 'bg-green-500',
                exercises: [
                    { id: 'l2e1', name: 'Belt Squat', sets: 4, reps: '10-12', rest: 120, muscle: 'Quads' },
                    { id: 'l2e2', name: 'Leg Extension', sets: 4, reps: '12-15', rest: 90, muscle: 'Quads' },
                    { id: 'l2e3', name: 'Bulgarian Split Squat', sets: 3, reps: '10-12 each', rest: 90, muscle: 'Quads/Glutes' },
                    { id: 'l2e4', name: 'Leg Press', sets: 3, reps: '12-15', rest: 90, muscle: 'Quads' },
                    { id: 'l2e5', name: 'Seated Leg Curl', sets: 3, reps: '12-15', rest: 90, muscle: 'Hamstrings' },
                    { id: 'l2e6', name: 'Seated Calf Raise', sets: 4, reps: '15-20', rest: 60, muscle: 'Calves' },
                    { id: 'l2e7', name: 'Hanging Leg Raise', sets: 3, reps: '12-15', rest: 60, muscle: 'Core' }
                ]
            }
        };

        class GymApp {
            constructor() {
                this.workouts = JSON.parse(localStorage.getItem('gymWorkouts')) || defaultWorkouts;
                this.workoutHistory = JSON.parse(localStorage.getItem('gymHistory')) || [];
                this.currentWorkout = null;
                this.activeExercise = null;
                this.workoutSession = null;
                this.editMode = false;
                this.editingExercise = null;
                this.showMenu = false;
                this.render();
            }

            save() {
                localStorage.setItem('gymWorkouts', JSON.stringify(this.workouts));
                localStorage.setItem('gymHistory', JSON.stringify(this.workoutHistory));
            }

            startWorkout(workoutId) {
                this.currentWorkout = this.workouts[workoutId];
                this.workoutSession = {
                    startTime: new Date().toISOString(),
                    workoutId: workoutId,
                    exercises: {}
                };
                this.render();
            }

            logExercise(exerciseId, data) {
                this.workoutSession.exercises[exerciseId] = data;
                this.render();
            }

            toggleExerciseComplete(exerciseId, e) {
                e.stopPropagation();
                const currentData = this.workoutSession.exercises[exerciseId];
                const exercise = this.currentWorkout.exercises.find(ex => ex.id === exerciseId);
                
                if (!currentData) {
                    this.logExercise(exerciseId, {
                        weight: '',
                        completedSets: Array(exercise.sets).fill(true),
                        notes: ''
                    });
                } else {
                    const allComplete = currentData.completedSets.every(s => s);
                    this.logExercise(exerciseId, {
                        ...currentData,
                        completedSets: Array(exercise.sets).fill(!allComplete)
                    });
                }
            }

            finishWorkout() {
                const history = {
                    id: Date.now(),
                    date: new Date().toISOString(),
                    workoutName: this.currentWorkout.name,
                    duration: Math.round((new Date() - new Date(this.workoutSession.startTime)) / 60000),
                    exercises: this.workoutSession.exercises
                };
                this.workoutHistory = [history, ...this.workoutHistory];
                this.save();
                this.currentWorkout = null;
                this.workoutSession = null;
                this.activeExercise = null;
                this.render();
            }

            addExercise(workoutId) {
                const newExercise = {
                    id: Date.now().toString(),
                    name: 'New Exercise',
                    sets: 3,
                    reps: '10-12',
                    rest: 90,
                    muscle: 'Muscle Group'
                };
                this.workouts[workoutId].exercises.push(newExercise);
                this.save();
                this.render();
            }

            deleteExercise(workoutId, exerciseId) {
                if(confirm('Delete this exercise?')) {
                    this.workouts[workoutId].exercises = this.workouts[workoutId].exercises.filter(ex => ex.id !== exerciseId);
                    this.save();
                    this.render();
                }
            }

            updateExercise(workoutId, exerciseId, updates) {
                const workout = this.workouts[workoutId];
                const exerciseIndex = workout.exercises.findIndex(ex => ex.id === exerciseId);
                workout.exercises[exerciseIndex] = { ...workout.exercises[exerciseIndex], ...updates };
                this.save();
                this.render();
            }

            render() {
                const app = document.getElementById('app');
                if (this.editingExercise) {
                    app.innerHTML = this.renderEditModal();
                } else if (this.activeExercise) {
                    app.innerHTML = this.renderExerciseDetail();
                } else if (this.currentWorkout) {
                    app.innerHTML = this.renderWorkoutList();
                } else {
                    app.innerHTML = this.renderHome();
                }
            }

            renderHome() {
                const workoutCards = Object.values(this.workouts).map(workout => `
                    <div class="bg-slate-800 rounded-xl overflow-hidden shadow-lg border border-slate-700/50 mb-4">
                        <button onclick="app.startWorkout('${workout.id}')" 
                                class="w-full p-5 text-left hover:bg-slate-700/50 transition-all ${this.editMode ? 'opacity-50 pointer-events-none' : ''}">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-4">
                                    <div class="${workout.color} w-12 h-12 rounded-lg flex items-center justify-center text-2xl shadow-inner">
                                        üèãÔ∏è
                                    </div>
                                    <div>
                                        <h3 class="text-xl font-bold">${workout.name}</h3>
                                        <p class="text-slate-400 text-sm">${workout.subtitle}</p>
                                    </div>
                                </div>
                                ${!this.editMode ? '<svg width="24" height="24" class="text-slate-600" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>' : ''}
                            </div>
                        </button>
                        ${this.editMode ? this.renderEditExercises(workout) : ''}
                    </div>
                `).join('');

                const historyHTML = this.workoutHistory.length > 0 ? `
                    <div class="p-4 mt-4">
                        <h2 class="text-xl font-bold mb-4 flex items-center gap-2">
                            <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
                            Recent History
                        </h2>
                        <div class="space-y-3">
                            ${this.workoutHistory.slice(0, 5).map(w => {
                                const details = Object.keys(w.exercises).map(exId => {
                                    let name = "Exercise";
                                    for(let cat in this.workouts) {
                                        const found = this.workouts[cat].exercises.find(e => e.id === exId);
                                        if(found) name = found.name;
                                    }
                                    return `<div class="flex justify-between text-xs py-1 border-b border-slate-700/50 last:border-0">
                                                <span class="text-slate-300">${name}</span>
                                                <span class="text-blue-400 font-bold">${w.exercises[exId].weight || '0'}kg</span>
                                            </div>`;
                                }).join('');

                                return `
                                <div class="bg-slate-800/50 rounded-lg p-4 border border-slate-700/50 border-l-4 border-l-blue-500">
                                    <div class="flex justify-between items-center mb-2">
                                        <h3 class="font-bold text-sm">${w.workoutName}</h3>
                                        <span class="text-slate-500 text-[10px] uppercase font-bold">${new Date(w.date).toLocaleDateString()}</span>
                                    </div>
                                    <div class="bg-slate-900/50 rounded p-2">${details}</div>
                                </div>`;
                            }).join('')}
                        </div>
                    </div>` : '';

                return `
                    <div class="min-h-screen pb-20 animate-fade-in">
                        <div class="bg-gradient-to-br from-blue-700 via-blue-600 to-indigo-700 p-6 pb-12 rounded-b-[2rem] shadow-xl">
                            <div class="flex items-center justify-between mb-4">
                                <h1 class="text-3xl font-black tracking-tight">GYM TRACKER</h1>
                                <button onclick="app.showMenu = !app.showMenu; app.render()" class="bg-white/10 p-2 rounded-lg">
                                    <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2.5"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
                                </button>
                            </div>
                            <p class="text-blue-100 font-medium">Ready for your session, Gymbro?</p>
                        </div>

                        ${this.showMenu ? `
                        <div class="p-4 -mt-6">
                            <button onclick="app.editMode = !app.editMode; app.showMenu = false; app.render()" 
                                    class="w-full bg-slate-900 border border-slate-700 p-4 rounded-xl flex items-center justify-center gap-3 font-bold shadow-2xl">
                                <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>
                                ${this.editMode ? 'Finish Customizing' : 'Customize Workouts'}
                            </button>
                        </div>` : '<div class="h-6"></div>'}

                        <div class="px-4">${workoutCards}</div>
                        ${historyHTML}
                    </div>`;
            }

            renderEditExercises(workout) {
                return `
                    <div class="p-4 bg-slate-900/80 space-y-2 border-t border-slate-700/50">
                        ${workout.exercises.map(ex => `
                            <div class="flex items-center justify-between bg-slate-800 p-3 rounded-lg border border-slate-700">
                                <div>
                                    <div class="text-white font-bold text-sm">${ex.name}</div>
                                    <div class="text-slate-400 text-xs">${ex.sets} sets ‚Ä¢ ${ex.reps} reps</div>
                                </div>
                                <div class="flex gap-2">
                                    <button onclick="app.editingExercise = { workoutId: '${workout.id}', exercise: ${JSON.stringify(ex).replace(/"/g, '&quot;')} }; app.render()"
                                            class="bg-blue-500/10 text-blue-400 p-2 rounded-md text-xs font-bold uppercase">Edit</button>
                                    <button onclick="app.deleteExercise('${workout.id}', '${ex.id}')"
                                            class="bg-red-500/10 text-red-400 p-2 rounded-md text-xs font-bold uppercase">‚úï</button>
                                </div>
                            </div>
                        `).join('')}
                        <button onclick="app.addExercise('${workout.id}')"
                                class="w-full bg-blue-600/10 text-blue-400 p-3 rounded-lg flex items-center justify-center gap-2 mt-2 border border-blue-600/20 font-bold text-sm">
                            + Add New Exercise
                        </button>
                    </div>`;
            }

            renderWorkoutList() {
                const exerciseCards = this.currentWorkout.exercises.map(exercise => {
                    const sessionData = this.workoutSession.exercises[exercise.id];
                    const isComplete = sessionData?.completedSets.every(Boolean);

                    return `
                        <div class="w-full bg-slate-800 rounded-xl p-4 flex items-center gap-4 mb-3 border border-slate-700/50 shadow-sm">
                            <button onclick="app.activeExercise = ${JSON.stringify(exercise).replace(/"/g, '&quot;')}; app.render()"
                                    class="flex-1 text-left">
                                <h3 class="font-bold text-lg leading-tight mb-1">${exercise.name}</h3>
                                <div class="flex gap-3 text-[10px] font-bold text-slate-500 uppercase tracking-widest">
                                    <span class="bg-slate-900 px-2 py-0.5 rounded">${exercise.sets} SETS</span>
                                    <span class="bg-slate-900 px-2 py-0.5 rounded">${exercise.reps} REPS</span>
                                </div>
                            </button>
                            <button onclick="app.toggleExerciseComplete('${exercise.id}', event)" class="p-1">
                                ${isComplete ? 
                                    '<svg width="36" height="36" class="text-green-500" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" /></svg>' :
                                    '<svg width="36" height="36" class="text-slate-700" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="12" cy="12" r="10"/></svg>'
                                }
                            </button>
                        </div>`;
                }).join('');

                return `
                    <div class="min-h-screen pb-24 animate-fade-in">
                        <div class="${this.currentWorkout.color} p-6 sticky top-0 z-10 shadow-xl rounded-b-2xl">
                            <button onclick="app.currentWorkout = null; app.workoutSession = null; app.render()" 
                                    class="mb-4 bg-black/20 px-3 py-1 rounded-full text-xs font-bold flex items-center gap-1 w-fit">‚Üê QUIT SESSION</button>
                            <h1 class="text-2xl font-black">${this.currentWorkout.name}</h1>
                            <p class="text-white/80 text-sm font-medium">${this.currentWorkout.subtitle}</p>
                        </div>
                        <div class="p-4">${exerciseCards}</div>
                        <div class="fixed bottom-0 left-0 right-0 p-4 bg-slate-950/80 backdrop-blur-lg border-t border-slate-800">
                            <button onclick="app.finishWorkout()"
                                    class="w-full bg-green-600 hover:bg-green-500 text-white font-black py-4 rounded-2xl shadow-lg transition-transform active:scale-95">
                                FINISH WORKOUT
                            </button>
                        </div>
                    </div>`;
            }

            renderExerciseDetail() {
                const sessionData = this.workoutSession.exercises[this.activeExercise.id] || {
                    weight: '',
                    completedSets: Array(this.activeExercise.sets).fill(false),
                    notes: ''
                };

                const setButtons = Array.from({length: this.activeExercise.sets}, (_, i) => `
                    <button onclick="app.toggleSet('${this.activeExercise.id}', ${i})"
                            class="w-full p-4 rounded-xl flex items-center justify-between transition-all mb-2 border ${
                                sessionData.completedSets[i] ? 'bg-green-600 border-green-400 shadow-lg' : 'bg-slate-800 border-slate-700'
                            }">
                        <span class="font-black text-xs uppercase">SET ${i + 1}</span>
                        <span class="font-bold">${this.activeExercise.reps} REPS</span>
                        ${sessionData.completedSets[i] ? '‚úì' : ''}
                    </button>
                `).join('');

                return `
                    <div class="min-h-screen pb-24 animate-fade-in">
                        <div class="${this.currentWorkout.color} p-6 rounded-b-2xl shadow-lg">
                            <button onclick="app.activeExercise = null; app.render()" class="mb-4 font-bold text-xs uppercase bg-black/20 px-3 py-1 rounded-full">‚Üê BACK</button>
                            <h1 class="text-2xl font-black leading-tight">${this.activeExercise.name}</h1>
                            <p class="text-white/80 text-sm font-bold uppercase tracking-widest mt-1">${this.activeExercise.muscle} ‚Ä¢ ${this.activeExercise.rest}S REST</p>
                        </div>
                        <div class="p-4 space-y-4">
                            <div class="bg-slate-800 rounded-2xl p-4 border border-slate-700">
                                <label class="block text-[10px] font-black text-slate-500 uppercase tracking-widest mb-2">Current Weight (kg)</label>
                                <input type="number" inputmode="decimal" id="weightInput" value="${sessionData.weight}" placeholder="0"
                                       class="w-full bg-slate-900 text-white text-3xl font-black p-4 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none border border-slate-700">
                            </div>
                            <div>
                                <label class="block text-[10px] font-black text-slate-500 uppercase tracking-widest mb-2 px-1">Checklist</label>
                                ${setButtons}
                            </div>
                            <div class="bg-slate-800 rounded-2xl p-4 border border-slate-700">
                                <label class="block text-[10px] font-black text-slate-500 uppercase tracking-widest mb-2">Notes</label>
                                <textarea id="notesInput" placeholder="How did it feel?" class="w-full bg-slate-900 text-white p-4 rounded-xl h-24 resize-none border border-slate-700 outline-none">${sessionData.notes || ''}</textarea>
                            </div>
                        </div>
                        <div class="fixed bottom-0 left-0 right-0 p-4 bg-slate-950/80 backdrop-blur-lg border-t border-slate-800">
                            <button onclick="app.saveDetailsAndBack()"
                                    class="w-full bg-blue-600 py-4 rounded-2xl font-black shadow-lg uppercase tracking-widest">
                                Save Progress
                            </button>
                        </div>
                    </div>`;
            }

            renderEditModal() {
                const ex = this.editingExercise.exercise;
                return `
                    <div class="fixed inset-0 bg-black/90 flex items-center justify-center p-4 z-50 backdrop-blur-sm animate-fade-in">
                        <div class="bg-slate-800 rounded-3xl p-6 w-full max-w-md border border-slate-700 shadow-2xl">
                            <h2 class="text-xl font-black mb-6 uppercase tracking-tight">Edit Exercise</h2>
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-[10px] font-black text-slate-500 uppercase mb-1">Exercise Name</label>
                                    <input type="text" id="editName" value="${ex.name}" class="w-full bg-slate-900 text-white p-4 rounded-xl border border-slate-700 outline-none">
                                </div>
                                <div class="grid grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-[10px] font-black text-slate-500 uppercase mb-1">Sets</label>
                                        <input type="number" id="editSets" value="${ex.sets}" class="w-full bg-slate-900 text-white p-4 rounded-xl border border-slate-700 outline-none">
                                    </div>
                                    <div>
                                        <label class="block text-[10px] font-black text-slate-500 uppercase mb-1">Reps/Time</label>
                                        <input type="text" id="editReps" value="${ex.reps}" class="w-full bg-slate-900 text-white p-4 rounded-xl border border-slate-700 outline-none">
                                    </div>
                                </div>
                                <div class="pt-4 space-y-2">
                                    <button onclick="app.saveEdit()" class="w-full bg-blue-600 text-white font-black py-4 rounded-2xl shadow-lg">UPDATE</button>
                                    <button onclick="app.editingExercise = null; app.render()" class="w-full text-slate-500 font-bold py-2">CANCEL</button>
                                </div>
                            </div>
                        </div>
                    </div>`;
            }

            toggleSet(exerciseId, setNum) {
                const sessionData = this.workoutSession.exercises[exerciseId] || {
                    weight: '',
                    completedSets: Array(this.activeExercise.sets).fill(false),
                    notes: ''
                };
                sessionData.completedSets[setNum] = !sessionData.completedSets[setNum];
                this.logExercise(exerciseId, sessionData);
            }

            saveDetailsAndBack() {
                const sessionData = this.workoutSession.exercises[this.activeExercise.id] || {
                    completedSets: Array(this.activeExercise.sets).fill(false)
                };
                sessionData.weight = document.getElementById('weightInput').value;
                sessionData.notes = document.getElementById('notesInput').value;
                this.logExercise(this.activeExercise.id, sessionData);
                this.activeExercise = null;
                this.render();
            }

            saveEdit() {
                const name = document.getElementById('editName').value;
                const sets = parseInt(document.getElementById('editSets').value);
                const reps = document.getElementById('editReps').value;
                this.updateExercise(this.editingExercise.workoutId, this.editingExercise.exercise.id, { name, sets, reps });
                this.editingExercise = null;
                this.render();
            }
        }

        const app = new GymApp();
    </script>
</body>
</html>
